<!-- website/includes/navbar.html -->
<nav class="navbar navbar-expand-lg fixed-top" id="mainNavbar">
    <div class="container-fluid container-lg">
        <!-- Brand Logo -->
        <a class="navbar-brand d-flex align-items-center" href="{% url 'website:home' %}">
            <div class="logo-wrapper">
                <span class="logo-text-primary">ServiceLink</span>
                <span class="logo-text-secondary">BPO</span>
            </div>
        </a>
        
        <!-- Desktop Navigation -->
        <div class="desktop-nav d-none d-lg-flex align-items-center">
            <ul class="navbar-nav mx-auto mb-0">
                <li class="nav-item">
                    <a class="nav-link position-relative px-3" href="{% url 'website:home' %}">
                        <span class="nav-text">Home</span>
                        <span class="nav-hover-effect"></span>
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link position-relative px-3" href="{% url 'website:about' %}">
                        <span class="nav-text">About</span>
                        <span class="nav-hover-effect"></span>
                    </a>
                </li>
                
                <!-- Services Mega Menu -->
                <li class="nav-item dropdown mega-menu">
                    <a class="nav-link dropdown-toggle position-relative px-3" 
                       href="{% url 'website:services' %}" 
                       data-bs-toggle="dropdown" 
                       aria-expanded="false">
                        <span class="nav-text">Services</span>
                        <span class="nav-hover-effect"></span>
                        <i class="fas fa-chevron-down dropdown-arrow ms-1"></i>
                    </a>
                    <div class="dropdown-menu mega-dropdown p-0 border-0 shadow-lg">
                        <div class="container-fluid px-4 py-3">
                            <div class="row g-4">
                                <div class="col-lg-8">
                                    <div class="row row-cols-2 g-4">
                                        {% for category in categories|slice:":6" %}
                                        <div class="col">
                                            <a href="{% url 'website:services' %}#{{ category.slug }}" 
                                               class="service-category-card d-flex p-3 text-decoration-none">
                                                <div class="service-icon me-3">
                                                    <i class="{{ category.icon|default:'fas fa-cogs' }}"></i>
                                                </div>
                                                <div>
                                                    <h6 class="mb-1 text-dark fw-semibold">{{ category.name }}</h6>
                                                    <p class="small mb-0 text-muted">{{ category.description|truncatechars:60|default:'Professional services' }}</p>
                                                </div>
                                            </a>
                                        </div>
                                        {% empty %}
                                        <!-- Fallback if no categories -->
                                        {% for i in "123456"|make_list %}
                                        <div class="col">
                                            <a href="{% url 'website:services' %}" 
                                               class="service-category-card d-flex p-3 text-decoration-none">
                                                <div class="service-icon me-3">
                                                    <i class="fas fa-{% cycle 'headset' 'chart-line' 'laptop-code' 'bullhorn' 'database' 'users' %}"></i>
                                                </div>
                                                <div>
                                                    <h6 class="mb-1 text-dark fw-semibold">{% cycle 'Customer Service' 'Finance & Accounting' 'IT Solutions' 'Digital Marketing' 'Data Analytics' 'Back Office' %}</h6>
                                                    <p class="small mb-0 text-muted">{% cycle '24/7 customer support' 'Financial processing' 'IT development' 'Marketing campaigns' 'Data analysis' 'Admin support' %}</p>
                                                </div>
                                            </a>
                                        </div>
                                        {% endfor %}
                                        {% endfor %}
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mega-cta h-100 p-4 border rounded">
                                        <h6 class="mb-3 text-primary fw-bold">Need Custom Solution?</h6>
                                        <p class="small mb-4 text-muted">Let's build a tailored service package for your business needs.</p>
                                        <a href="{% url 'website:contact' %}" class="btn btn-outline-primary w-100">
                                            <i class="fas fa-envelope me-2"></i>Request Quote
                                        </a>
                                        <div class="mt-4 pt-3 border-top">
                                            <div class="d-flex align-items-center mb-2">
                                                <i class="fas fa-check-circle text-primary me-2"></i>
                                                <small class="text-muted">24/7 Support</small>
                                            </div>
                                            <div class="d-flex align-items-center mb-2">
                                                <i class="fas fa-check-circle text-primary me-2"></i>
                                                <small class="text-muted">Custom Solutions</small>
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <i class="fas fa-check-circle text-primary me-2"></i>
                                                <small class="text-muted">Scalable Teams</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-4 pt-3 border-top">
                                <div class="col-12 text-center">
                                    <a href="{% url 'website:services' %}" class="btn btn-link text-primary">
                                        View All Services <i class="fas fa-arrow-right ms-2"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link position-relative px-3" href="{% url 'website:contact' %}">
                        <span class="nav-text">Contact</span>
                        <span class="nav-hover-effect"></span>
                    </a>
                </li>
            </ul>
            
            <!-- Desktop CTA -->
            <a href="{% if request.path == '/' %}#home-consultation{% else %}{% url 'website:home' %}#home-consultation{% endif %}" 
               class="btn btn-primary ms-4 px-4">
                <i class="fas fa-calendar-check me-2"></i>
                Free Consultation
            </a>
        </div>
        
        <!-- Mobile Toggle Button -->
        <button class="navbar-toggler d-lg-none border-0 shadow-none bg-transparent" 
                type="button" 
                id="mobileMenuToggle"
                aria-label="Toggle navigation">
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        
        <!-- Mobile Navigation Overlay -->
        <div class="mobile-nav-overlay" id="mobileNavOverlay"></div>
        
        <!-- Mobile Navigation Sidebar -->
        <div class="mobile-nav-sidebar" id="mobileNavSidebar">
            <div class="mobile-nav-header d-flex align-items-center justify-content-between p-4">
                <div class="logo-wrapper">
                    <span class="logo-text-primary">ServiceLink</span>
                    <span class="logo-text-secondary">BPO</span>
                </div>
                <button class="mobile-nav-close btn-close btn-close-dark" 
                        type="button" 
                        id="mobileNavClose"
                        aria-label="Close"></button>
            </div>
            
            <div class="mobile-nav-content p-4">
                <ul class="mobile-nav-list list-unstyled mb-0">
                    <li class="mb-2">
                        <a href="{% url 'website:home' %}" class="mobile-nav-link d-flex align-items-center py-3 px-3 text-decoration-none rounded">
                            <i class="fas fa-home fa-fw me-3"></i>
                            <span>Home</span>
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="{% url 'website:about' %}" class="mobile-nav-link d-flex align-items-center py-3 px-3 text-decoration-none rounded">
                            <i class="fas fa-info-circle fa-fw me-3"></i>
                            <span>About Us</span>
                        </a>
                    </li>
                    <li class="mb-2">
                        <div class="mobile-dropdown">
                            <button class="mobile-nav-link d-flex align-items-center justify-content-between w-100 py-3 px-3 text-decoration-none rounded border-0 bg-transparent"
                                    type="button"
                                    data-bs-toggle="collapse"
                                    data-bs-target="#mobileServicesCollapse"
                                    aria-expanded="false"
                                    aria-controls="mobileServicesCollapse">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-cogs fa-fw me-3"></i>
                                    <span>Services</span>
                                </div>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="collapse" id="mobileServicesCollapse">
                                <div class="ps-4 mt-2">
                                    {% for category in categories %}
                                    <a href="{% url 'website:services' %}#{{ category.slug }}" 
                                       class="mobile-submenu-link d-flex align-items-center py-2 text-decoration-none">
                                        <i class="fas fa-chevron-right fa-xs me-2"></i>
                                        <span>{{ category.name }}</span>
                                    </a>
                                    {% empty %}
                                    <a href="{% url 'website:services' %}" 
                                       class="mobile-submenu-link d-flex align-items-center py-2 text-decoration-none">
                                        <i class="fas fa-chevron-right fa-xs me-2"></i>
                                        <span>All Services</span>
                                    </a>
                                    {% endfor %}
                                    <a href="{% url 'website:services' %}" 
                                       class="mobile-submenu-link d-flex align-items-center py-2 text-decoration-none text-primary fw-semibold">
                                        <i class="fas fa-arrow-right fa-xs me-2"></i>
                                        <span>View All Services</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li class="mb-2">
                        <a href="{% url 'website:contact' %}" class="mobile-nav-link d-flex align-items-center py-3 px-3 text-decoration-none rounded">
                            <i class="fas fa-envelope fa-fw me-3"></i>
                            <span>Contact</span>
                        </a>
                    </li>
                </ul>
                
                <div class="mobile-cta mt-5 pt-4 border-top">
                    <a href="tel:+8801886100303" class="btn btn-outline-primary d-flex align-items-center justify-content-center w-100 mb-3 py-3">
                        <i class="fas fa-phone me-2"></i>
                        <span>Call Now</span>
                    </a>
                    <a href="{% url 'website:contact' %}" class="btn btn-primary d-flex align-items-center justify-content-center w-100 py-3">
                        <i class="fas fa-calendar-check me-2"></i>
                        <span>Get Consultation</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</nav>

<style>
/* ===== BASE RESET ===== */
#mainNavbar {
    padding: 1rem 0;
    transition: all 0.4s ease;
    z-index: 1030;
    background: transparent !important;
}

#mainNavbar.scrolled {
    padding: 0.5rem 0;
    background: rgba(255, 255, 255, 0.98) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.08);
}

/* Logo Styles */
.logo-wrapper {
    display: flex;
    align-items: center;
}

.logo-text-primary {
    font-size: 1.75rem;
    font-weight: 800;
    background: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.logo-text-secondary {
    font-size: 1.75rem;
    font-weight: 600;
    color: #1e3c72;
}

#mainNavbar:not(.scrolled) .logo-text-secondary {
    color: white;
}

/* ===== DESKTOP NAVIGATION ===== */
.desktop-nav {
    width: 100%;
    justify-content: space-between;
}

.desktop-nav .navbar-nav {
    gap: 1rem;
}

/* Nav Link Base */
.nav-link {
    position: relative;
    padding: 0.5rem 1rem !important;
    font-weight: 500;
    font-size: 1rem;
    color: #2d3748 !important;
    border-radius: 8px;
    transition: all 0.3s ease;
}

#mainNavbar:not(.scrolled) .nav-link {
    color: rgb(39, 23, 23) !important;
}

.nav-link .dropdown-arrow {
    font-size: 0.8rem;
    transition: transform 0.3s ease;
}

.dropdown-toggle.show .dropdown-arrow {
    transform: rotate(180deg);
}

/* Hover Effect */
.nav-hover-effect {
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%) scaleX(0);
    width: 80%;
    height: 2px;
    background: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%);
    border-radius: 1px;
    transition: transform 0.3s ease;
}

.nav-link:hover .nav-hover-effect,
.nav-link.active .nav-hover-effect {
    transform: translateX(-50%) scaleX(1);
}

#mainNavbar:not(.scrolled) .nav-hover-effect {
    background: white;
}

/* Dropdown Mega Menu */
.mega-dropdown {
    min-width: 800px;
    max-width: 1000px;
    left: 50% !important;
    transform: translateX(-50%) !important;
    margin-top: 10px !important;
    border-radius: 16px !important;
    animation: dropdownFadeIn 0.3s ease-out !important;
}

@keyframes dropdownFadeIn {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-10px) !important;
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0) !important;
    }
}

/* Service Category Cards */
.service-category-card {
    border: 1px solid rgba(0, 0, 0, 0.08);
    border-radius: 12px;
    transition: all 0.3s ease;
}

.service-category-card:hover {
    border-color: #4361ee;
    background: rgba(67, 97, 238, 0.02);
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(67, 97, 238, 0.1);
}

.service-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.service-icon i {
    color: white;
    font-size: 1rem;
}

/* Mega CTA Box */
.mega-cta {
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
}

/* ===== MOBILE NAVIGATION ===== */
/* Hamburger Menu */
.hamburger {
    width: 30px;
    height: 24px;
    position: relative;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.hamburger span {
    display: block;
    width: 100%;
    height: 3px;
    background: #4361ee;
    border-radius: 3px;
    transition: all 0.3s ease;
    transform-origin: left center;
}

#mainNavbar:not(.scrolled) .hamburger span {
    background: white;
}

.hamburger.active span:nth-child(1) {
    transform: rotate(45deg) translate(4px, -3px);
    width: 28px;
}

.hamburger.active span:nth-child(2) {
    opacity: 0;
    transform: translateX(-10px);
}

.hamburger.active span:nth-child(3) {
    transform: rotate(-45deg) translate(4px, 3px);
    width: 28px;
}

/* Mobile Overlay */
.mobile-nav-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 1040;
}

.mobile-nav-overlay.active {
    opacity: 1;
    visibility: visible;
}

/* Mobile Sidebar */
.mobile-nav-sidebar {
    position: fixed;
    top: 0;
    right: -100%;
    width: 320px;
    max-width: 90%;
    height: 100%;
    background: white;
    box-shadow: -5px 0 30px rgba(0, 0, 0, 0.15);
    transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 1050;
    display: flex;
    flex-direction: column;
}

.mobile-nav-sidebar.active {
    right: 0;
}

/* Mobile Header */
.mobile-nav-header {
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.mobile-nav-close {
    opacity: 0.7;
    transition: opacity 0.3s ease;
    font-size: 1.5rem;
}

.mobile-nav-close:hover {
    opacity: 1;
}

/* Mobile Content */
.mobile-nav-content {
    flex: 1;
    overflow-y: auto;
}

.mobile-nav-link {
    color: #2d3748;
    transition: all 0.3s ease;
    border-radius: 8px;
}

.mobile-nav-link:hover,
.mobile-nav-link.active {
    background: rgba(67, 97, 238, 0.1);
    color: #4361ee;
}

.mobile-nav-link[aria-expanded="true"] {
    background: rgba(67, 97, 238, 0.1);
    color: #4361ee;
}

.mobile-nav-link[aria-expanded="true"] .fa-chevron-down {
    transform: rotate(180deg);
}

.mobile-dropdown .collapse {
    transition: height 0.3s ease;
}

.mobile-submenu-link {
    color: #64748b;
    transition: all 0.3s ease;
    border-radius: 6px;
    padding-left: 1.5rem;
}

.mobile-submenu-link:hover {
    color: #4361ee;
    background: rgba(67, 97, 238, 0.08);
}

/* Mobile CTA */
.mobile-cta {
    border-top: 1px solid rgba(0, 0, 0, 0.1);
}

/* ===== BUTTONS ===== */
.btn-primary {
    background: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%);
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 10px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(67, 97, 238, 0.3);
}

.btn-outline-primary {
    border: 2px solid #4361ee;
    color: #4361ee;
    background: transparent;
    transition: all 0.3s ease;
}

.btn-outline-primary:hover {
    background: #4361ee;
    color: white;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 1199.98px) {
    .mega-dropdown {
        min-width: 700px;
    }
}

@media (max-width: 991.98px) {
    .desktop-nav {
        display: none !important;
    }
    
    .mobile-nav-sidebar {
        width: 300px;
    }
}

@media (max-width: 575.98px) {
    .mobile-nav-sidebar {
        width: 280px;
    }
    
    .logo-text-primary,
    .logo-text-secondary {
        font-size: 1.5rem;
    }
}

/* Fix Bootstrap dropdown issues */
.dropdown-menu {
    border: none;
    margin: 0;
}

.dropdown-toggle::after {
    display: none;
}

/* Ensure navbar doesn't cover content */
body {
    padding-top: 76px;
}

/* Fix for transparent navbar issue */
#mainNavbar:not(.scrolled) {
    background: transparent !important;
}

#mainNavbar:not(.scrolled) .nav-link:hover {
    background: rgba(255, 255, 255, 0.1);
}
</style>






<script>
document.addEventListener('DOMContentLoaded', function() {
    const navbar = document.getElementById('mainNavbar');
    const hamburger = document.querySelector('.hamburger');
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const mobileNavOverlay = document.getElementById('mobileNavOverlay');
    const mobileNavSidebar = document.getElementById('mobileNavSidebar');
    const mobileNavClose = document.getElementById('mobileNavClose');
    
    // Scroll handler
    function handleScroll() {
        if (window.scrollY > 50) {
            navbar.classList.add('scrolled');
        } else {
            navbar.classList.remove('scrolled');
        }
    }
    
    // Initialize scroll state
    handleScroll();
    window.addEventListener('scroll', handleScroll);
    
    // Mobile menu functionality
    function openMobileMenu() {
        mobileNavOverlay.classList.add('active');
        mobileNavSidebar.classList.add('active');
        hamburger.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
    
    function closeMobileMenu() {
        mobileNavOverlay.classList.remove('active');
        mobileNavSidebar.classList.remove('active');
        hamburger.classList.remove('active');
        document.body.style.overflow = '';
    }
    
    // Event listeners
    mobileMenuToggle.addEventListener('click', openMobileMenu);
    mobileNavClose.addEventListener('click', closeMobileMenu);
    mobileNavOverlay.addEventListener('click', closeMobileMenu);
    
    // Close menu when clicking a link (mobile)
    document.querySelectorAll('.mobile-nav-link[href], .mobile-submenu-link').forEach(link => {
        link.addEventListener('click', function(e) {
            if (this.getAttribute('href') !== '#') {
                closeMobileMenu();
            }
        });
    });
    
    // Fix dropdown on other pages
    function initializeBootstrapDropdowns() {
        // Initialize Bootstrap dropdowns
        const dropdownElements = document.querySelectorAll('.dropdown-toggle');
        dropdownElements.forEach(dropdown => {
            dropdown.addEventListener('click', function(e) {
                if (window.innerWidth >= 992) {
                    e.preventDefault();
                    const dropdownMenu = this.nextElementSibling;
                    const isVisible = dropdownMenu.classList.contains('show');
                    
                    // Close all other dropdowns
                    document.querySelectorAll('.dropdown-menu').forEach(menu => {
                        menu.classList.remove('show');
                    });
                    
                    // Toggle current dropdown
                    if (!isVisible) {
                        dropdownMenu.classList.add('show');
                    }
                }
            });
        });
        
        // Close dropdowns when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.dropdown')) {
                document.querySelectorAll('.dropdown-menu').forEach(menu => {
                    menu.classList.remove('show');
                });
            }
        });
    }
    
    // Initialize dropdowns
    initializeBootstrapDropdowns();
    
    // Re-initialize on window resize
    window.addEventListener('resize', function() {
        initializeBootstrapDropdowns();
        
        // Close mobile menu on desktop
        if (window.innerWidth >= 992) {
            closeMobileMenu();
        }
    });
    
    // Hover effect for desktop dropdown
    if (window.innerWidth >= 992) {
        const megaMenu = document.querySelector('.mega-menu');
        const megaDropdown = document.querySelector('.mega-dropdown');
        
        if (megaMenu && megaDropdown) {
            let hideTimeout;
            
            megaMenu.addEventListener('mouseenter', function() {
                clearTimeout(hideTimeout);
                megaDropdown.classList.add('show');
            });
            
            megaMenu.addEventListener('mouseleave', function() {
                hideTimeout = setTimeout(() => {
                    megaDropdown.classList.remove('show');
                }, 300);
            });
            
            megaDropdown.addEventListener('mouseenter', function() {
                clearTimeout(hideTimeout);
            });
            
            megaDropdown.addEventListener('mouseleave', function() {
                hideTimeout = setTimeout(() => {
                    megaDropdown.classList.remove('show');
                }, 300);
            });
        }
    }
    
    // Set active nav link based on current page
    function setActiveNavLink() {
        const currentPath = window.location.pathname;
        const navLinks = document.querySelectorAll('.nav-link:not(.dropdown-toggle), .mobile-nav-link[href]');
        
        navLinks.forEach(link => {
            const linkPath = link.getAttribute('href');
            if (linkPath === currentPath || 
                (currentPath === '/' && linkPath === '/') ||
                (currentPath.includes('services') && linkPath && linkPath.includes('services'))) {
                link.classList.add('active');
            } else {
                link.classList.remove('active');
            }
        });
    }
    
    setActiveNavLink();
    
    // Close dropdowns when clicking on body (except dropdown)
    document.addEventListener('click', function(e) {
        if (!e.target.closest('.dropdown') && !e.target.closest('.mega-dropdown')) {
            document.querySelectorAll('.dropdown-menu').forEach(menu => {
                menu.classList.remove('show');
            });
        }
    });
});
</script>